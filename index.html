<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>THE AEON-PROOF ARCHIVE ‚Äî FLAME Sovereign Verification Package</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
/* ---------- Base ---------- */
*{box-sizing:border-box}
html,body{margin:0;padding:0}
body{font-family:Georgia,"Times New Roman",serif;background:#1a1a2e;color:#eee;line-height:1.5}

/* ---------- Colors / tokens ---------- */
:root{
  --gold-1:#ffcc33; --gold-2:#ffd966; --gold-3:#fff2b2; /* Bright Metallic (luminous) */
  --gold:#d4af37; --ink:#0a0e27; --panel:#16213e; --edge:#0f3460;
  --indigo1:#1e3c72; --indigo2:#2a5298; --mid:#203a43; --dark:#0f2027;
  --ok:#7fff7f; --muted:#c9c9c9;
}

/* ---------- Header ---------- */
.header-banner{
  background:linear-gradient(135deg,var(--dark) 0%,var(--mid) 50%,#2c5364 100%);
  border-bottom:3px solid var(--gold); padding:28px 20px; text-align:center;
  box-shadow:0 4px 20px rgba(0,0,0,.5); position:relative;
}
.archive-title{font-size:2.6rem;color:var(--gold);font-weight:700;letter-spacing:2px;margin:0 0 8px;text-shadow:2px 2px 4px rgba(0,0,0,.7)}
.archive-subtitle{font-size:1.15rem;color:#ddd;font-style:italic;margin:0 0 12px}
.banking-subtitle{font-size:1rem;color:var(--ok);display:inline-block;padding:6px 16px;border-radius:6px;background:rgba(127,255,127,.12)}

.btn-main{
  position:absolute;top:16px;right:16px;display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end
}
.btn{
  background:linear-gradient(135deg,var(--indigo1) 0%,var(--indigo2) 100%);
  color:var(--gold); border:1px solid var(--gold); padding:10px 16px; border-radius:8px;
  font-weight:700; cursor:pointer; transition:all .2s; font-family:inherit
}
.btn:hover{filter:brightness(1.05);transform:translateY(-1px)}
.btn.alt{background:linear-gradient(135deg,var(--gold-1),var(--gold-2))}
.btn.alt:hover{filter:brightness(1.06)}

/* ---------- Reference bar ---------- */
.reference-bar{background:rgba(212,175,55,.14);border:1px solid var(--gold);border-radius:10px;padding:12px;margin-top:16px}
.reference-bar table{width:100%;color:#eee}
.reference-bar td{padding:6px 10px;vertical-align:top}
.reference-bar strong{color:var(--gold)}

/* ---------- Containers ---------- */
.container{max-width:1200px;margin:0 auto;padding:28px 20px}

/* ---------- Executive banking summary (fixed spacing) ---------- */
.executive-banking-summary{
  background:linear-gradient(135deg,var(--indigo1) 0%,var(--indigo2) 100%);
  border:3px solid var(--gold); border-radius:16px; padding:26px; margin:26px 0;
  box-shadow:0 8px 26px rgba(0,0,0,.45)
}
.executive-banking-summary h2{
  color:var(--gold); font-size:1.6rem; text-align:center; margin:0 0 18px;
  padding-bottom:12px; border-bottom:2px solid rgba(212,175,55,.28)
}
.banking-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px}
.banking-card{background:rgba(212,175,55,.10);border:2px solid var(--gold);border-radius:10px;padding:14px}
.banking-card .label{color:#f0f0f0;font-size:.9rem;margin-bottom:6px}
.banking-card .value{color:var(--gold);font-size:1.25rem;font-weight:700}
.banking-card .value.highlight{color:var(--ok);font-size:1.4rem}

.banking-explanation{
  background:rgba(15,52,96,.35); border-left:4px solid var(--ok);
  padding:14px; border-radius:10px; margin-top:16px
}
.banking-explanation h4{color:var(--ok);margin:0 0 8px}

/* ---------- Status ---------- */
.status-banner{
  background:linear-gradient(135deg,var(--indigo1) 0%,var(--indigo2) 100%);
  border:2px solid var(--gold); border-radius:12px; padding:20px; margin:24px 0; text-align:center
}
.status-banner h2{color:var(--gold);margin:0 0 10px;font-size:1.3rem}
.status-check{display:inline-block;margin:6px 12px;color:var(--ok);font-size:1rem}

/* ---------- Modules ---------- */
.verification-module{
  background:var(--panel); border:2px solid var(--edge); border-radius:14px; padding:20px; margin:18px 0; position:relative
}
.module-header{display:flex;align-items:center;justify-content:space-between;gap:12px;border-bottom:2px solid var(--edge);padding-bottom:12px}
.module-title{display:flex;align-items:center;gap:12px}
.module-number{
  background:conic-gradient(from 0deg,var(--gold-1),var(--gold-2),var(--gold-3));
  color:#111; width:42px;height:42px;border-radius:50%;display:grid;place-items:center;font-weight:800
}
.module-title h2{color:var(--gold);font-size:1.2rem;margin:0}
.term-translation{display:block;color:#bbb;font-size:.85rem}
.module-controls{display:flex;gap:10px;flex-wrap:wrap}
.btn-support{background:linear-gradient(135deg,var(--indigo1),var(--indigo2));border:1px solid var(--gold);color:var(--gold);padding:8px 12px;border-radius:8px;cursor:pointer}
.btn-print-mini{background:linear-gradient(135deg,var(--gold-1),var(--gold-2));color:#111;border:1px solid #b8941f;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700}

.module-content{margin-top:14px}
.input-group{margin:10px 0}
.input-group label{display:block;margin-bottom:6px;color:#ddd;font-weight:700}
.input-group input,.input-group textarea{
  width:100%;padding:12px;background:var(--ink);border:2px solid var(--edge);border-radius:8px;color:#eee;font-family:"Courier New",monospace
}
.explanation-box{background:rgba(15,52,96,.30);border-left:4px solid var(--gold);padding:14px;border-radius:10px;color:#e8e8e8}
.button-group{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
.btn-verify{background:linear-gradient(135deg,var(--gold-1),var(--gold-2));color:#111;border:1px solid #b8941f;border-radius:8px;padding:10px 14px;font-weight:800;cursor:pointer}
.btn-validate{background:linear-gradient(135deg,var(--indigo1),var(--indigo2));color:var(--gold);border:1px solid var(--gold);border-radius:8px;padding:10px 14px;font-weight:800;cursor:pointer}

/* ---------- Gold Seal ---------- */
.flame-seal{margin:28px 0 0;padding:18px;border-top:2px solid var(--edge);text-align:center}
.flame-seal .seal{
  width:120px;height:120px;margin:0 auto 10px;border-radius:50%;
  background:conic-gradient(from 0deg,var(--gold-1),var(--gold-2),var(--gold-3),var(--gold-2),var(--gold-1));
  box-shadow:0 0 0 4px rgba(255,204,51,.25),0 8px 28px rgba(0,0,0,.4);
  position:relative
}
.flame-seal .seal:after{
  content:"AVA"; position:absolute; inset:0; display:grid; place-items:center;
  font-weight:900; letter-spacing:1px; color:#111; text-shadow:0 1px 0 rgba(255,255,255,.6);
  font-size:24px
}
.flame-seal p{margin:4px 0}
.flame-seal .fine{color:#bdbdbd;font-size:.95rem}

/* ---------- Download cards (kept but print-independent) ---------- */
.pdf-download-section{
  background:linear-gradient(135deg,#16213e 0%,#0f1620 100%);
  border:3px solid var(--gold); border-radius:16px; padding:22px; margin:24px 0
}
.pdf-download-section h2{color:var(--gold);text-align:center;margin:0 0 8px}
.pdf-buttons-container{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.pdf-button-card{background:rgba(212,175,55,.10);border:2px solid var(--gold);border-radius:12px;padding:18px}
.pdf-button-card h3{color:var(--gold);margin:0 0 8px}
.pdf-button-card p{color:#dcdcdc;margin:0 0 12px}
.pdf-download-btn{width:100%;background:linear-gradient(135deg,var(--gold-1),var(--gold-2));color:#111;border:1px solid #b8941f;border-radius:8px;padding:12px 16px;font-weight:800;cursor:pointer}

/* ---------- Screen tweaks ---------- */
@media (max-width:900px){
  .pdf-buttons-container{grid-template-columns:1fr}
}

/* ---------- Print (A4, zero overlap, single-page certificate) ---------- */
@media print{
  @page{size:A4;margin:12mm 14mm}
  body{background:#fff;color:#000}
  .btn-main,.pdf-download-section,.btn-support,.btn-verify,.btn-validate{display:none !important}

  /* Only show the requested section */
  body.printing #print-certificate-only,
  body.printing #print-all,
  body.printing .print-this-module{
    display:block !important
  }

  /* Hide everything by default during printing */
  #root > *{display:none !important}

  /* Certificate single page: avoid breaks inside its blocks */
  #print-certificate-only,
  #print-certificate-only .header-banner,
  #print-certificate-only .executive-banking-summary,
  #print-certificate-only .status-banner,
  #print-certificate-only .flame-seal{page-break-inside:avoid}

  /* All-pages print respects module page breaks */
  #print-all .verification-module{page-break-inside:avoid;margin-bottom:10mm}
}

/* Utility wrappers used by printSection() cloning */
.print-surface{max-width:900px;margin:0 auto}
.section-title{font-weight:800;color:var(--gold);margin:0 0 10px;font-size:1.2rem}
</style>
</head>
<body>

<div id="root">

  <!-- ========== CERTIFICATE (A4 single page) ========== -->
  <section id="print-certificate-only" class="print-surface">
    <div class="header-banner">
      <div class="btn-main">
        <button class="btn" id="btn-print-certificate">Print Certificate</button>
        <button class="btn alt" id="btn-print-all">Print All Details</button>
      </div>
      <div class="archive-title">THE AEON-PROOF ARCHIVE</div>
      <div class="archive-subtitle">FLAME Sovereign Verification Package</div>
      <div class="banking-subtitle">Independent Third-Party Audit ‚Ä¢ Traditional Wire Settlement</div>

      <div class="reference-bar">
        <table><tbody>
          <tr>
            <td><strong>Registry Reference:</strong> PFC-2025-001-7B3A</td>
            <td><strong>Issued To:</strong> GB Dynamics Inc.</td>
          </tr>
          <tr>
            <td><strong>Verification Timestamp:</strong> 2024-10-28T13:40:00Z</td>
            <td><strong>Settlement:</strong> Traditional Wire Transfer ‚Ä¢ Blockchain = Proof Only</td>
          </tr>
          <tr>
            <td colspan="2" style="text-align:center">
              <strong>External Auditor:</strong> Aeonic Verification Assembly (AVA)
            </td>
          </tr>
        </tbody></table>
      </div>
    </div>

    <div class="container">
      <!-- Executive summary (tightened spacing, no overlaps) -->
      <div class="executive-banking-summary">
        <h2>$1 Billion Funding Authorization ‚Äî Independently Audited</h2>

        <div class="banking-grid">
          <div class="banking-card">
            <div class="label">Authorized Funding</div>
            <div class="value highlight">$1,000,000,000</div>
          </div>
          <div class="banking-card">
            <div class="label">Collateral Pool</div>
            <div class="value">$18,200,000,000</div>
          </div>
          <div class="banking-card">
            <div class="label">Coverage Ratio</div>
            <div class="value">18.2:1</div>
            <div style="font-size:.9rem;color:var(--ok);margin-top:4px">(5.49% utilization)</div>
          </div>
          <div class="banking-card">
            <div class="label">Authorized Recipient</div>
            <div class="value" style="font-size:1.15rem">GB Dynamics Inc.</div>
          </div>
        </div>

        <div class="banking-explanation">
          <h4>For Banking & Compliance Teams</h4>
          <p style="margin:0">
            This authorization functions like a <strong>notarized bank guarantee</strong> with cryptographic proof.
            The blockchain serves as an <strong>independent public registry</strong> (similar to CUSIP or land records),
            confirming authenticity and ownership. Settlement occurs via <strong>traditional wire transfer</strong> ‚Äî
            the blockchain provides verification only, not payment processing.
          </p>
        </div>
      </div>

      <div class="status-banner">
        <h2>‚úÖ Verification Status: Cryptographically Valid</h2>
        <div style="margin-top:8px">
          <span class="status-check">‚ñ† Signatory Authorization Confirmed</span>
          <span class="status-check">‚ñ† Ownership Record Verified</span>
          <span class="status-check">‚ñ† Collateral Documentation Audited</span>
          <span class="status-check">‚ñ† Data Integrity Verified</span>
          <span class="status-check">‚ñ† Funding Authorization Valid</span>
        </div>
      </div>

      <!-- Gold Seal -->
      <div class="flame-seal">
        <div class="seal" aria-hidden="true"></div>
        <p><strong>Issued by:</strong> The Aeonic Verification Assembly (AVA)</p>
        <p class="fine">
          Independent third-party verification for institutional review under <em>Immutable Laws</em>
          (Pub. L. 98‚Äì181, title I [title IX, ¬ß 904], Nov. 30, 1983, 97 Stat. 1279.)
        </p>
        <p class="fine">All verification operations use standard mathematical procedures and can be independently confirmed.</p>
        <p class="fine"><strong>AEONIC AVA Technology ‚Ä¢ AE Core Token (ERC-721)</strong></p>
      </div>
    </div>
  </section>
  <!-- ========== /CERTIFICATE ========== -->


  <!-- ========== ALL DETAILS (certificate + modules) ========== -->
  <section id="print-all" class="print-surface" style="margin-top:28px">
    <h3 class="section-title">Complete Verification (Certificate + Modules)</h3>

    <!-- include certificate clone visually for screen; printSection() will clone DOM anyway -->
    <div id="certificate-shadow" aria-hidden="true"></div>

    <!-- Module 1 -->
    <article class="verification-module print-this-module" id="module-1">
      <div class="module-header">
        <div class="module-title">
          <span class="module-number">1</span>
          <div>
            <h2>Controller Signature Verification</h2>
            <span class="term-translation">Banking: Notarized Signature</span>
          </div>
        </div>
        <div class="module-controls">
          <button class="btn-support"
            onclick="alert('Digital signature verified using ECDSA cryptography ‚Äî equivalent to a notarized signature with mathematical proof of authenticity.')">üìö Banking Context</button>
          <button class="btn-print-mini" onclick="printSection('module-1')">Print This Module</button>
        </div>
      </div>
      <div class="module-content">
        <div class="explanation-box">
          <p style="margin:0">
            Confirms the <strong>digital signature</strong> of the authorized controlling officer.
            Uses industry-standard ECDSA; provides mathematical proof that cannot be forged or repudiated.
          </p>
        </div>
        <div class="input-group">
          <label>Attestation Nonce <span class="term-translation">Unique Authorization ID</span></label>
          <input type="text" value="c9bb59fe5b9dd943d4757692b977fbbb" readonly />
        </div>
        <div class="input-group">
          <label>Authorized Signatory Address <span class="term-translation">Digital Signature ID</span></label>
          <input type="text" value="0xAefd8aa7EcfCFA8041Dc66796A6eF673D108e36b" readonly />
        </div>
        <div class="input-group">
          <label>Message Hash <span class="term-translation">Signature Fingerprint</span></label>
          <input type="text" value="0xf4513db63b078a06c02995af41f3f0b6801aa6c4eda949f9174e01dfada9661c" readonly />
        </div>
        <div class="button-group">
          <button class="btn-verify" onclick="alert('Signature verification complete! Mathematically valid.')">‚ö° Verify Authorization Signature</button>
        </div>
      </div>
    </article>

    <!-- Module 2 -->
    <article class="verification-module print-this-module" id="module-2">
      <div class="module-header">
        <div class="module-title">
          <span class="module-number">2</span>
          <div>
            <h2>Mint Transaction Validation</h2>
            <span class="term-translation">Banking: Registry Entry / CUSIP</span>
          </div>
        </div>
        <div class="module-controls">
          <button class="btn-support"
            onclick="alert('Blockchain registry functions like CUSIP ‚Äî unique identifier & immutable ownership record.')">üìö Banking Context</button>
          <button class="btn-print-mini" onclick="printSection('module-2')">Print This Module</button>
        </div>
      </div>
      <div class="module-content">
        <div class="explanation-box">
          <p style="margin:0">
            Verifies the <strong>ownership record</strong> on Ethereum (independent public registry).
          </p>
        </div>
        <div class="input-group">
          <label>Blockchain Transaction Hash <span class="term-translation">Registry Entry ID</span></label>
          <input type="text" value="0x3c686f30af14eeaaafe0b642579c8c039bd5214ef3df6a126af41b595e7e8ac2" readonly />
        </div>
        <div class="input-group">
          <label>Registry Contract Address <span class="term-translation">Public Registry Location</span></label>
          <input type="text" value="0x7bD550debE939a87843EE5Bd7aC9F0e21ab27180" readonly />
        </div>
        <div class="input-group">
          <label>Certificate ID <span class="term-translation">Token ID</span></label>
          <input type="text" value="1 (ERC-721)" readonly />
        </div>
        <div class="button-group">
          <button class="btn-verify" onclick="alert('Ownership record confirmed on Ethereum mainnet.')">‚õìÔ∏è Verify Registry Entry</button>
          <button class="btn-validate" onclick="window.open('https://etherscan.io/tx/0x3c686f30af14eeaaafe0b642579c8c039bd5214ef3df6a126af41b595e7e8ac2','_blank')">üîó View Public Registry Record</button>
        </div>
      </div>
    </article>

    <!-- Module 3 -->
    <article class="verification-module print-this-module" id="module-3">
      <div class="module-header">
        <div class="module-title">
          <span class="module-number">3</span>
          <div>
            <h2>Document Portfolio Verification</h2>
            <span class="term-translation">Banking: Portfolio Audit</span>
          </div>
        </div>
        <div class="module-controls">
          <button class="btn-support" onclick="alert('Merkle tree verification allows efficient validation of an entire document portfolio.')">üìö Banking Context</button>
          <button class="btn-print-mini" onclick="printSection('module-3')">Print This Module</button>
        </div>
      </div>
      <div class="module-content">
        <div class="explanation-box">
          <p style="margin:0">
            Verifies the integrity of the complete <strong>$18.2B collateral portfolio</strong> backing the authorization.
          </p>
        </div>
        <div style="background:rgba(127,255,127,.12);padding:14px;border-radius:10px;border:2px solid var(--ok);margin-bottom:12px">
          <p style="color:var(--ok);font-weight:700;margin:0 0 6px">Collateral Coverage Analysis</p>
          <p style="margin:0;color:#e8e8e8">
            <strong>Total Portfolio Value:</strong> $18,200,000,000<br/>
            <strong>Authorized Release:</strong> $1,000,000,000<br/>
            <strong>Coverage Ratio:</strong> 18.2:1 (exceptional over-collateralization)<br/>
            <strong>Utilization:</strong> Only 5.49% of available collateral
          </p>
        </div>
        <div class="input-group">
          <label>Verified Portfolio Documents</label>
          <textarea rows="5" readonly>FLAME Authorization Certificate v1.0
Lien Portfolio Attestation ($18.2B USD)
Controller Authority Documentation
Sovereign Framework Activation Record
Legal Attestation Bundle (35 USC ¬ß284 + 12 USC ¬ß3903 + 31 USC ¬ß3730)</textarea>
        </div>
        <div class="button-group">
          <button class="btn-verify" onclick="alert('Portfolio integrity verified: all document fingerprints match.')">üå≥ Verify Portfolio Integrity</button>
        </div>
      </div>
    </article>

    <!-- Module 4 -->
    <article class="verification-module print-this-module" id="module-4">
      <div class="module-header">
        <div class="module-title">
          <span class="module-number">4</span>
          <div>
            <h2>Attestation Hash Verification</h2>
            <span class="term-translation">Banking: Data Integrity / Tamper Detection</span>
          </div>
        </div>
        <div class="module-controls">
          <button class="btn-support" onclick="alert('Hashes function like SWIFT authentication codes ‚Äî any tampering is detected.')">üìö Banking Context</button>
          <button class="btn-print-mini" onclick="printSection('module-4')">Print This Module</button>
        </div>
      </div>
      <div class="module-content">
        <div class="explanation-box">
          <p style="margin:0">
            Cryptographic hashes create unique digital fingerprints; any change yields a different hash, enabling deterministic tamper detection.
          </p>
        </div>
        <div class="input-group">
          <label>Attestation Data (Pre-Loaded)</label>
          <textarea rows="5" readonly>FLAME Protocol Attestation
Registry Reference: PFC-2025-001-7B3A
Authorized Signatory: 0xAefd8aa7EcfCFA8041Dc66796A6eF673D108e36b
Timestamp: 2024-10-28T13:40:00Z
Verification: All Cryptographic Elements Valid</textarea>
        </div>
        <div class="button-group">
          <button class="btn-verify" onclick="alert('Data integrity verified: fingerprints match the registry.')">üîê Verify Document Fingerprints</button>
        </div>
      </div>
    </article>

    <!-- Module 5 -->
    <article class="verification-module print-this-module" id="module-5">
      <div class="module-header">
        <div class="module-title">
          <span class="module-number">5</span>
          <div>
            <h2>$1B AEON Release Authorization</h2>
            <span class="term-translation">Banking: Wire Authorization / Credit Line</span>
          </div>
        </div>
        <div class="module-controls">
          <button class="btn-support" onclick="alert('Irrevocable and non-repudiable authorization, analogous to an LC.')">üìö Banking Context</button>
          <button class="btn-print-mini" onclick="printSection('module-5')">Print This Module</button>
        </div>
      </div>
      <div class="module-content">
        <div class="explanation-box" style="border-left-color:var(--gold);background:rgba(212,175,55,.14)">
          <p style="margin:0"><strong>Settlement Method:</strong> Traditional Bank Wire</p>
          <p style="margin:.4rem 0 0">Blockchain provides <strong>proof of authorization</strong> only; it is not the payment rail.</p>
          <p style="margin:.4rem 0 0"><strong>Status:</strong> Irrevocable & non-repudiable</p>
        </div>

        <div class="input-group"><label>Authorization Amount</label><input value="$1,000,000,000.00 USD" readonly/></div>
        <div class="input-group"><label>Authorized Recipient</label><input value="GB Dynamics Inc." readonly/></div>
        <div class="input-group"><label>Underlying Collateral</label><input value="$18,200,000,000.00 USD (Sovereign Lien Portfolio)" readonly/></div>
        <div class="input-group"><label>Settlement Method</label><input value="Traditional Bank Wire Transfer (Blockchain = Proof Only)" readonly/></div>
      </div>
    </article>
  </section>
  <!-- ========== /ALL DETAILS ========== -->

</div>

<script>
/* ========= Print helpers (3 working actions) ========= */
/**
 * Print only a specific section by ID.
 * - Opens a clean A4 print frame with the cloned section content.
 * - Adds base styles + minimal sheet wrapper to avoid cutoffs.
 */
function printSection(sectionId){
  const el = document.getElementById(sectionId);
  if(!el){ console.warn('Missing section:', sectionId); return; }

  // Build an isolated document for printing
  const win = window.open('', '_blank');
  win.document.write('<html><head><title>Print</title>');
  win.document.write(`
    <style>
      @page{size:A4;margin:12mm 14mm}
      body{font-family:Georgia,"Times New Roman",serif;line-height:1.5;color:#000;background:#fff}
      .sheet{max-width:900px;margin:0 auto}
      .header-banner,.executive-banking-summary,.status-banner,.verification-module,.flame-seal{page-break-inside:avoid}
      .verification-module{border:1px solid #999;border-radius:10px;padding:14px;margin:10px 0}
      .reference-bar{border:1px solid #999;border-radius:8px;padding:10px;background:#fafafa}
      .archive-title{font-size:22pt;font-weight:800;color:#000}
      .archive-subtitle{font-size:12pt;color:#333}
      .banking-subtitle{font-size:11pt;color:#333;background:#f6f6f6;padding:6px 10px;border-radius:6px;display:inline-block}
      .seal{width:110px;height:110px;border-radius:50%;
            background:conic-gradient(from 0deg,#ffcc33,#ffd966,#fff2b2,#ffd966,#ffcc33);
            box-shadow:0 0 0 3px rgba(255,204,51,.25),0 6px 22px rgba(0,0,0,.35); margin:0 auto 8px}
      .seal:after{content:"AVA";display:grid;place-items:center;height:100%;font-weight:900;color:#111;letter-spacing:1px}
    </style>
  `);
  win.document.write('</head><body>');
  const sheet = win.document.createElement('div');
  sheet.className = 'sheet';
  sheet.appendChild(el.cloneNode(true));
  win.document.body.appendChild(sheet);
  win.document.close();
  // Ensure images/fonts render before printing
  setTimeout(()=>{ win.focus(); win.print(); win.close(); }, 50);
}

/* Print certificate button (A4 single page) */
document.getElementById('btn-print-certificate')
  ?.addEventListener('click', ()=>printSection('print-certificate-only'));

/* Print all details (certificate + modules, multi-page) */
document.getElementById('btn-print-all')
  ?.addEventListener('click', ()=>printSection('print-all'));

/* Keep the ‚Äúcertificate clone‚Äù preview in ALL section synced (screen only) */
(function syncCertificateShadow(){
  const shadow = document.getElementById('certificate-shadow');
  const cert = document.getElementById('print-certificate-only');
  if(shadow && cert){
    const clone = cert.cloneNode(true);
    // remove header buttons from the clone preview
    const buttons = clone.querySelector('.btn-main');
    if(buttons) buttons.remove();
    shadow.innerHTML = '';
    shadow.appendChild(clone);
  }
})();
</script>

</body>
</html>
